{% macro random_string(len) -%}{% for i in range(0,len) -%}{{ [0,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f"]|random }}{% endfor %}{%- endmacro -%}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="iTachWeb Device Dashboard" />
    <meta name="author" content="Ryan Edwards-Crewe" />
    <title>iTachWeb | Dashboard</title>
    <link href="{{ url_for('static', path='/css/bootstrap.min.css') }}" rel="stylesheet" />
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', path='/apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', path='/favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', path='/favicon-16x16.png') }}">
    <link rel="manifest" href="/site.webmanifest">
    <!-- <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script> -->
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary bg-dark border-bottom border-body" data-bs-theme="dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">iTachWeb</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Dropdown
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Content -->
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h2>Device Dashboard</h2>
            </div>
        </div>
        <div class="row">
            {% for device in devices %}
            <div class="card w-75 mb-3" style="max-width: 540px;">
                <div class="row g-0">
                    <div class="col-md-4">
                        <img src="{{ url_for('static', path='/img/ip2cc.png') }}" class="img-fluid rounded-start"
                            alt="IP2CC Controller">
                    </div>
                    <div class="col-md-8" style="background-color:#ffc107;">
                        <div class="card-body overflow-hidden">
                            <h5 class="card-title">{{ device.name }}</h5>
                            <p class="card-text" style="font-family:monospace;">
                                Host: <a href="http://{{ device.host }}" target="_device_access">
                                    http://{{ device.host }}</a>
                            </p>
                            <div class="row" style="text-align:left;">
                                <div class="">
                                    {% for p, p_data in device.contact_closure.items() %}
                                    <div class="form-check form-switch">
                                        {% set guid = random_string(8) %}
                                        {% for name, state in p_data.items() %}
                                        <input class="form-check-input" type="checkbox" role="switch"
                                            id="flexSwitchCheckDefault-{{ p }}-{{ guid }}" {{ "checked" if state == 1 else "" }}/>
                                        <label class="form-check-label" for="flexSwitchCheckDefault-{{ p }}-{{ guid }}"
                                            style="font-family:monospace;">
                                            Port {{ p }}: {{ name }}
                                        </label>
                                        {% endfor %}
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <script src="{{ url_for('static', path='/js/bootstrap.bundle.min.js') }}"></script>
        <script src="{{ url_for('static', path='/js/jquery-3.7.1.min.js') }}"></script>
        <script src="{{ url_for('static', path='/scripts/scripts.js') }}"></script>
</body>

</html>